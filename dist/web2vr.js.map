{"version":3,"sources":["webpack://Web2VR/webpack/universalModuleDefinition","webpack://Web2VR/webpack/bootstrap","webpack://Web2VR/./node_modules/aframe-gif-shader/dist/aframe-gif-shader.js","webpack://Web2VR/./node_modules/deepmerge/dist/cjs.js","webpack://Web2VR/./src/aframeContext.js","webpack://Web2VR/./src/assetManager.js","webpack://Web2VR/./src/components/animate.js","webpack://Web2VR/./src/components/border.js","webpack://Web2VR/./src/components/grabRotateStatic.js","webpack://Web2VR/./src/components/renderer.js","webpack://Web2VR/./src/components/scrollbar.js","webpack://Web2VR/./src/elements/buttonElement.js","webpack://Web2VR/./src/elements/canvasElement.js","webpack://Web2VR/./src/elements/checkboxElement.js","webpack://Web2VR/./src/elements/containerElement.js","webpack://Web2VR/./src/elements/element.js","webpack://Web2VR/./src/elements/imageElement.js","webpack://Web2VR/./src/elements/inputElement.js","webpack://Web2VR/./src/elements/radioElement.js","webpack://Web2VR/./src/elements/svgElement.js","webpack://Web2VR/./src/elements/textElement.js","webpack://Web2VR/./src/elements/videoElement.js","webpack://Web2VR/./src/plugins/eventListenerListPlugin.js","webpack://Web2VR/./src/scroll.js","webpack://Web2VR/./src/settings.js","webpack://Web2VR/./src/utils/helper.js","webpack://Web2VR/./src/utils/mouseEventHandler.js","webpack://Web2VR/./src/utils/position.js","webpack://Web2VR/./src/web2vr.js"],"names":["AframeContext","settings","inVR","createScene","assetManager","AssetManager","scene","document","getElementsByTagName","length","createElement","body","appendChild","newScene","debug","setAttribute","addEventListener","bind","web2vr","container","classList","add","interactiveTag","width","parseFloat","window","getComputedStyle","scale","x","position","object3D","set","y","z","rotation","parentElement","querySelector","parentSelector","assets","currentAssetId","parseInt","getAttribute","updateCurrentAssetId","path","type","getChildren","asset","createAsset","id","remove","AFRAME","registerComponent","init","running","el","element","domElement","startAnimation","stopAnimation","tick","update","schema","color","plane","children","edges","THREE","EdgesGeometry","geometry","line","LineSegments","LineBasicMaterial","linewidth","data","borderObject","aframe","clippingContext","material","clippingPlanes","planes","needsUpdate","borderWidth","borderColor","Color","updateBorder","visible","clone","layerStep","components","grabbed","scroll","hasScroll","elements","updateClipping","obj","hand","grabbers","Math","atan2","sceneEl","renderer","localClippingEnabled","evt","scrollHeight","firstElementChild","style","height","scrollWindowHeight","scrollContainer","clientHeight","scrollY","detail","intersection","uv","shift","pointer","setY","pointEndY","pointStartY","play","scrollbar","setX","setZ","ButtomElement","layer","tagName","textValue","value","replace","TextElement","CanvasElement","imageId","entity","src","assetId","getAsset","removeAsset","updateImage","toDataURL","Element","CheckBoxElement","specificUpdate","checked","ContainerElement","textOnly","console","log","click","expImageId","oldBackgroundImage","oldDomPosition","backgroundColor","backgroundImage","experimental","equalsDOMPosition","customId","html2canvasIDcounter","html2canvas","onclone","head","sheet","insertRule","removeAttribute","then","canvas","Helper","isUrl","substring","lastIndexOf","updateOpacity","domPosition","alpha","split","a","b","opacity","childElements","Set","contains","paddingToMargin","Position","getBoundingClientRect","parentTransform","needsStartingTransformSize","initHover","mouseEventHandle","MouseEventHandler","resync","animationDuration","transitionDuration","tag","hoverSelectors","has","toLowerCase","classes","cls","push","transform","hoverTransform","depth","startDepth","querySelectorAll","textContent","trim","right","paddingRight","marginRight","initEventHandlers","setupClipping","clientRect","aframePosition","scrollBody","updatePosition","checkVisible","visibility","display","listeningForMouseEvents","checkAnimation","updateTransform","matrixType","values","map","v","matrix","Matrix4","fromArray","Vector3","quaternion","Quaternion","decompose","scalingFactor","setFromRotationMatrix","scaleX","sqrt","scaleY","border","borderTopWidth","borderTopColor","normal","normalMatrix","Matrix3","getNormalMatrix","matrixWorld","output","applyMatrix3","normalize","parentNode","overflow","forceClipping","authority","bottom","Plane","rotateNormal","top","left","getClippingContext","setTimeout","bottomLocal","multiplyScalar","topLocal","leftLocal","rightLocal","bottomGlobal","localToWorld","topGlobal","leftGlobal","rightGlobal","setFromNormalAndCoplanarPoint","showClipping","clippingPlaneHelpers","MeshBasicMaterial","side","DoubleSide","PlaneGeometry","mesh","Mesh","debugPlane","axisHelper","AxesHelper","helper","worldPos","getWorldPosition","point","projectPoint","focalPoint","lookAt","ImageElement","currentSrc","changed","loaded","assetID","isGif","test","InputElement","active","emit","placeholder","RadioElement","SvgElement","svgString","XMLSerializer","serializeToString","ctx","getContext","DOMURL","self","URL","webkitURL","img","Image","svg","Blob","url","createObjectURL","onload","drawImage","revokeObjectURL","svgToImage","text","fragmentShader","vertexShader","clipping","align","textAlign","includes","lineHeight","currentFont","common","actualFontSize","fontSize","widthInPixels","wrapPixels","textColor","updateTextSize","updateTextAlignment","updateText","updateTextColor","VideoElement","video360","createClickEvent","hasAttribute","image","pause","paused","updateCurrentAssetIdReturn","degToRad","forEach","prototype","_addEventListener","handle","useCapture","eventListenerList","node","removeEventListener","eventDetail","addedEvent","CustomEvent","dispatchEvent","_removeEventListener","filter","listener","toString","removedEvent","Scroll","checkScrollbar","createScrollbar","scrollingElement","Settings","ignoreTags","createControllers","raycasterFar","skybox","string","regexp","min","max","checkEntityEvents","mouseEvents","mouseProperties","hasMouseEventRegistered","mouseEvent","hasMouseProperty","mouseProperty","addMouseListeners","removeMouseListeners","MouseEvent","eventName","mouseEventHandler","calculateAFramePosition","Web2VR","nodeType","Node","ELEMENT_NODE","Deepmerge","arrayMerge","destination","source","observer","observerConfig","childList","subtree","characterData","attributes","updating","styleSheets","styleSheet","cssRules","rule","CSSStyleRule","selectors","selectorText","selector","sel","s","substr","error","svgDomElement","styleDefs","sheets","i","rules","j","elems","cssText","innerHTML","defs","insertBefore","firstChild","findHoverCss","hasLoaded","once","createContainer","convertToVR","allLoadedUpdate","interval","setInterval","allLoaded","clearInterval","TEXT_NODE","nodeValue","span","disconnect","replaceWith","observe","ButtonElement","onLoaded","event","removeChild","child","removeElement","currentNode","generateStyleDefs","addElement","childNodes","addElementChildren","MutationObserver","mutations","mutation","emptyRemove","removedNodes","addedNodes","target","err"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA,6BAA6B;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;;AAEA,qGAAqG,mBAAmB,EAAE,mBAAmB,kGAAkG;;AAE/O;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;AACX;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,aAAa,gBAAgB;AAC7B,WAAW,gBAAgB;;AAE3B;AACA,WAAW,gBAAgB;AAC3B,gBAAgB;;AAEhB,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA,kDAAkD,sBAAsB;AACxE;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA,cAAc,YAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN,IAAI;;;AAGJ;AACA;AACA,cAAc,OAAO;AACrB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,iBAAiB,OAAO;AACxB,iBAAiB,OAAO;AACxB,iBAAiB,MAAM;AACvB,iBAAiB,OAAO;AACxB,iBAAiB,MAAM;AACvB,iBAAiB,KAAK;AACtB;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU;AACV;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,IAAI;;;AAGJ;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV,QAAQ;AACR,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,MAAM;AACN;AACA,eAAe;AACf;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB,cAAc,MAAM;AACpB,cAAc,OAAO;AACrB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU;AACV,yDAAyD;AACzD;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,QAAQ;AACR,yDAAyD;AACzD;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACpqBa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA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","file":"web2vr.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Web2VR\"] = factory();\n\telse\n\t\troot[\"Web2VR\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/web2vr.js\");\n","/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\n\tvar _gifsparser = __webpack_require__(1);\n\n\tif (typeof AFRAME === 'undefined') {\n\t  throw 'Component attempted to register before AFRAME was available.';\n\t}\n\n\t/* get util from AFRAME */\n\tvar parseUrl = AFRAME.utils.srcLoader.parseUrl;\n\tvar debug = AFRAME.utils.debug;\n\t// debug.enable('shader:gif:*')\n\n\tdebug.enable('shader:gif:warn');\n\tvar warn = debug('shader:gif:warn');\n\tvar log = debug('shader:gif:debug');\n\n\t/* store data so that you won't load same data */\n\tvar gifData = {};\n\n\t/* create error message */\n\tfunction createError(err, src) {\n\t  return { status: 'error', src: src, message: err, timestamp: Date.now() };\n\t}\n\n\tAFRAME.registerShader('gif', {\n\n\t  /**\n\t   * For material component:\n\t   * @see https://github.com/aframevr/aframe/blob/60d198ef8e2bfbc57a13511ae5fca7b62e01691b/src/components/material.js\n\t   * For example of `registerShader`:\n\t   * @see https://github.com/aframevr/aframe/blob/41a50cd5ac65e462120ecc2e5091f5daefe3bd1e/src/shaders/flat.js\n\t   * For MeshBasicMaterial\n\t   * @see http://threejs.org/docs/#Reference/Materials/MeshBasicMaterial\n\t   */\n\n\t  schema: {\n\n\t    /* For material */\n\t    color: { type: 'color' },\n\t    fog: { default: true },\n\n\t    /* For texuture */\n\t    src: { default: null },\n\t    autoplay: { default: true }\n\n\t  },\n\n\t  /**\n\t   * Initialize material. Called once.\n\t   * @protected\n\t   */\n\t  init: function init(data) {\n\t    log('init', data);\n\t    log(this.el.components);\n\t    this.__cnv = document.createElement('canvas');\n\t    this.__cnv.width = 2;\n\t    this.__cnv.height = 2;\n\t    this.__ctx = this.__cnv.getContext('2d');\n\t    this.__texture = new THREE.Texture(this.__cnv); //renders straight from a canvas\n\t    this.__material = {};\n\t    this.__reset();\n\t    this.material = new THREE.MeshBasicMaterial({ map: this.__texture });\n\t    this.el.sceneEl.addBehavior(this);\n\t    this.__addPublicFunctions();\n\t    return this.material;\n\t  },\n\n\n\t  /**\n\t   * Update or create material.\n\t   * @param {object|null} oldData\n\t   */\n\t  update: function update(oldData) {\n\t    log('update', oldData);\n\t    this.__updateMaterial(oldData);\n\t    this.__updateTexture(oldData);\n\t    return this.material;\n\t  },\n\n\n\t  /**\n\t   * Called on each scene tick.\n\t   * @protected\n\t   */\n\t  tick: function tick(t) {\n\t    if (!this.__frames || this.paused()) return;\n\t    if (Date.now() - this.__startTime >= this.__nextFrameTime) {\n\t      this.nextFrame();\n\t    }\n\t  },\n\n\n\t  /*================================\n\t  =            material            =\n\t  ================================*/\n\n\t  /**\n\t   * Updating existing material.\n\t   * @param {object} data - Material component data.\n\t   */\n\t  __updateMaterial: function __updateMaterial(data) {\n\t    var material = this.material;\n\n\t    var newData = this.__getMaterialData(data);\n\t    Object.keys(newData).forEach(function (key) {\n\t      material[key] = newData[key];\n\t    });\n\t  },\n\n\n\t  /**\n\t   * Builds and normalize material data, normalizing stuff along the way.\n\t   * @param {Object} data - Material data.\n\t   * @return {Object} data - Processed material data.\n\t   */\n\t  __getMaterialData: function __getMaterialData(data) {\n\t    return {\n\t      fog: data.fog,\n\t      color: new THREE.Color(data.color)\n\t    };\n\t  },\n\n\n\t  /*==============================\n\t  =            texure            =\n\t  ==============================*/\n\n\t  /**\n\t   * set texure\n\t   * @private\n\t   * @param {Object} data\n\t   * @property {string} status - success / error\n\t   * @property {string} src - src url\n\t   * @property {array} times - array of time length of each image\n\t   * @property {number} cnt - total counts of gif images\n\t   * @property {array} frames - array of each image\n\t   * @property {Date} timestamp - created at the texure\n\t   */\n\n\t  __setTexure: function __setTexure(data) {\n\t    log('__setTexure', data);\n\t    if (data.status === 'error') {\n\t      warn('Error: ' + data.message + '\\nsrc: ' + data.src);\n\t      this.__reset();\n\t    } else if (data.status === 'success' && data.src !== this.__textureSrc) {\n\t      this.__reset();\n\t      /* Texture added or changed */\n\t      this.__ready(data);\n\t    }\n\t  },\n\n\n\t  /**\n\t   * Update or create texure.\n\t   * @param {Object} data - Material component data.\n\t   */\n\t  __updateTexture: function __updateTexture(data) {\n\t    var src = data.src;\n\t    var autoplay = data.autoplay;\n\n\t    /* autoplay */\n\n\t    if (typeof autoplay === 'boolean') {\n\t      this.__autoplay = autoplay;\n\t    } else if (typeof autoplay === 'undefined') {\n\t      this.__autoplay = true;\n\t    }\n\t    if (this.__autoplay && this.__frames) {\n\t      this.play();\n\t    }\n\n\t    /* src */\n\t    if (src) {\n\t      this.__validateSrc(src, this.__setTexure.bind(this));\n\t    } else {\n\t      /* Texture removed */\n\t      this.__reset();\n\t    }\n\t  },\n\n\n\t  /*=============================================\n\t  =            varidation for texure            =\n\t  =============================================*/\n\n\t  __validateSrc: function __validateSrc(src, cb) {\n\n\t    /* check if src is a url */\n\t    var url = parseUrl(src);\n\t    if (url) {\n\t      this.__getImageSrc(url, cb);\n\t      return;\n\t    }\n\n\t    var message = void 0;\n\n\t    /* check if src is a query selector */\n\t    var el = this.__validateAndGetQuerySelector(src);\n\t    if (!el || (typeof el === 'undefined' ? 'undefined' : _typeof(el)) !== 'object') {\n\t      return;\n\t    }\n\t    if (el.error) {\n\t      message = el.error;\n\t    } else {\n\t      var tagName = el.tagName.toLowerCase();\n\t      if (tagName === 'video') {\n\t        src = el.src;\n\t        message = 'For video, please use `aframe-video-shader`';\n\t      } else if (tagName === 'img') {\n\t        this.__getImageSrc(el.src, cb);\n\t        return;\n\t      } else {\n\t        message = 'For <' + tagName + '> element, please use `aframe-html-shader`';\n\t      }\n\t    }\n\n\t    /* if there is message, create error data */\n\t    if (message) {\n\t      (function () {\n\t        var srcData = gifData[src];\n\t        var errData = createError(message, src);\n\t        /* callbacks */\n\t        if (srcData && srcData.callbacks) {\n\t          srcData.callbacks.forEach(function (cb) {\n\t            return cb(errData);\n\t          });\n\t        } else {\n\t          cb(errData);\n\t        }\n\t        /* overwrite */\n\t        gifData[src] = errData;\n\t      })();\n\t    }\n\t  },\n\n\n\t  /**\n\t   * Validate src is a valid image url\n\t   * @param  {string} src - url that will be tested\n\t   * @param  {function} cb - callback with the test result\n\t   */\n\t  __getImageSrc: function __getImageSrc(src, cb) {\n\t    var _this = this;\n\n\t    /* if src is same as previous, ignore this */\n\t    if (src === this.__textureSrc) {\n\t      return;\n\t    }\n\n\t    /* check if we already get the srcData */\n\t    var srcData = gifData[src];\n\t    if (!srcData || !srcData.callbacks) {\n\t      /* create callback */\n\t      srcData = gifData[src] = { callbacks: [] };\n\t      srcData.callbacks.push(cb);\n\t    } else if (srcData.src) {\n\t      cb(srcData);\n\t      return;\n\t    } else if (srcData.callbacks) {\n\t      /* add callback */\n\t      srcData.callbacks.push(cb);\n\t      return;\n\t    }\n\t    var tester = new Image();\n\t    tester.crossOrigin = 'Anonymous';\n\t    tester.addEventListener('load', function (e) {\n\t      /* check if it is gif */\n\t      _this.__getUnit8Array(src, function (arr) {\n\t        if (!arr) {\n\t          onError('This is not gif. Please use `shader:flat` instead');\n\t          return;\n\t        }\n\t        /* parse data */\n\t        (0, _gifsparser.parseGIF)(arr, function (times, cnt, frames) {\n\t          /* store data */\n\t          var newData = { status: 'success', src: src, times: times, cnt: cnt, frames: frames, timestamp: Date.now() };\n\t          /* callbacks */\n\t          if (srcData.callbacks) {\n\t            srcData.callbacks.forEach(function (cb) {\n\t              return cb(newData);\n\t            });\n\t            /* overwrite */\n\t            gifData[src] = newData;\n\t          }\n\t        }, function (err) {\n\t          return onError(err);\n\t        });\n\t      });\n\t    });\n\t    tester.addEventListener('error', function (e) {\n\t      return onError('Could be the following issue\\n - Not Image\\n - Not Found\\n - Server Error\\n - Cross-Origin Issue');\n\t    });\n\t    function onError(message) {\n\t      /* create error data */\n\t      var errData = createError(message, src);\n\t      /* callbacks */\n\t      if (srcData.callbacks) {\n\t        srcData.callbacks.forEach(function (cb) {\n\t          return cb(errData);\n\t        });\n\t        /* overwrite */\n\t        gifData[src] = errData;\n\t      }\n\t    }\n\t    tester.src = src;\n\t  },\n\n\n\t  /**\n\t   *\n\t   * get mine type\n\t   *\n\t   */\n\t  __getUnit8Array: function __getUnit8Array(src, cb) {\n\t    if (typeof cb !== 'function') {\n\t      return;\n\t    }\n\n\t    var xhr = new XMLHttpRequest();\n\t    xhr.open('GET', src);\n\t    xhr.responseType = 'arraybuffer';\n\t    xhr.addEventListener('load', function (e) {\n\t      var uint8Array = new Uint8Array(e.target.response);\n\t      var arr = uint8Array.subarray(0, 4);\n\t      // const header = arr.map(value => value.toString(16)).join('')\n\t      var header = '';\n\t      for (var i = 0; i < arr.length; i++) {\n\t        header += arr[i].toString(16);\n\t      }\n\t      if (header === '47494638') {\n\t        cb(uint8Array);\n\t      } else {\n\t        cb();\n\t      }\n\t    });\n\t    xhr.addEventListener('error', function (e) {\n\t      log(e);\n\t      cb();\n\t    });\n\t    xhr.send();\n\t  },\n\n\n\t  /**\n\t   * Query and validate a query selector,\n\t   *\n\t   * @param  {string} selector - DOM selector.\n\t   * @return {object} Selected DOM element | error message object.\n\t   */\n\t  __validateAndGetQuerySelector: function __validateAndGetQuerySelector(selector) {\n\t    try {\n\t      var el = document.querySelector(selector);\n\t      if (!el) {\n\t        return { error: 'No element was found matching the selector' };\n\t      }\n\t      return el;\n\t    } catch (e) {\n\t      // Capture exception if it's not a valid selector.\n\t      return { error: 'no valid selector' };\n\t    }\n\t  },\n\n\n\t  /*================================\n\t  =            playback            =\n\t  ================================*/\n\n\t  /**\n\t   * add public functions\n\t   * @private\n\t   */\n\t  __addPublicFunctions: function __addPublicFunctions() {\n\t    this.el.gif = {\n\t      play: this.play.bind(this),\n\t      pause: this.pause.bind(this),\n\t      togglePlayback: this.togglePlayback.bind(this),\n\t      paused: this.paused.bind(this),\n\t      nextFrame: this.nextFrame.bind(this)\n\t    };\n\t  },\n\n\n\t  /**\n\t   * Pause gif\n\t   * @public\n\t   */\n\t  pause: function pause() {\n\t    log('pause');\n\t    this.__paused = true;\n\t  },\n\n\n\t  /**\n\t   * Play gif\n\t   * @public\n\t   */\n\t  play: function play() {\n\t    log('play');\n\t    this.__paused = false;\n\t  },\n\n\n\t  /**\n\t   * Toggle playback. play if paused and pause if played.\n\t   * @public\n\t   */\n\n\t  togglePlayback: function togglePlayback() {\n\n\t    if (this.paused()) {\n\t      this.play();\n\t    } else {\n\t      this.pause();\n\t    }\n\t  },\n\n\n\t  /**\n\t   * Return if the playback is paused.\n\t   * @public\n\t   * @return {boolean}\n\t   */\n\t  paused: function paused() {\n\t    return this.__paused;\n\t  },\n\n\n\t  /**\n\t   * Go to next frame\n\t   * @public\n\t   */\n\t  nextFrame: function nextFrame() {\n\t    this.__draw();\n\n\t    /* update next frame time */\n\t    while (Date.now() - this.__startTime >= this.__nextFrameTime) {\n\n\t      this.__nextFrameTime += this.__delayTimes[this.__frameIdx++];\n\t      if ((this.__infinity || this.__loopCnt) && this.__frameCnt <= this.__frameIdx) {\n\t        /* go back to the first */\n\t        this.__frameIdx = 0;\n\t      }\n\t    }\n\t  },\n\n\n\t  /*==============================\n\t   =            canvas            =\n\t   ==============================*/\n\n\t  /**\n\t   * clear canvas\n\t   * @private\n\t   */\n\t  __clearCanvas: function __clearCanvas() {\n\t    this.__ctx.clearRect(0, 0, this.__width, this.__height);\n\t    this.__texture.needsUpdate = true;\n\t  },\n\n\n\t  /**\n\t   * draw\n\t   * @private\n\t   */\n\t  __draw: function __draw() {\n\t    this.__ctx.drawImage(this.__frames[this.__frameIdx], 0, 0, this.__width, this.__height);\n\t    this.__texture.needsUpdate = true;\n\t  },\n\n\n\t  /*============================\n\t  =            ready            =\n\t  ============================*/\n\n\t  /**\n\t   * setup gif animation and play if autoplay is true\n\t   * @private\n\t   * @property {string} src - src url\n\t   * @param {array} times - array of time length of each image\n\t   * @param {number} cnt - total counts of gif images\n\t   * @param {array} frames - array of each image\n\t   */\n\t  __ready: function __ready(_ref) {\n\t    var src = _ref.src;\n\t    var times = _ref.times;\n\t    var cnt = _ref.cnt;\n\t    var frames = _ref.frames;\n\n\t    log('__ready');\n\t    this.__textureSrc = src;\n\t    this.__delayTimes = times;\n\t    cnt ? this.__loopCnt = cnt : this.__infinity = true;\n\t    this.__frames = frames;\n\t    this.__frameCnt = times.length;\n\t    this.__startTime = Date.now();\n\t    this.__width = THREE.Math.floorPowerOfTwo(frames[0].width);\n\t    this.__height = THREE.Math.floorPowerOfTwo(frames[0].height);\n\t    this.__cnv.width = this.__width;\n\t    this.__cnv.height = this.__height;\n\t    this.__draw();\n\t    if (this.__autoplay) {\n\t      this.play();\n\t    } else {\n\t      this.pause();\n\t    }\n\t  },\n\n\n\t  /*=============================\n\t  =            reset            =\n\t  =============================*/\n\n\t  /**\n\t   * @private\n\t   */\n\n\t  __reset: function __reset() {\n\t    this.pause();\n\t    this.__clearCanvas();\n\t    this.__startTime = 0;\n\t    this.__nextFrameTime = 0;\n\t    this.__frameIdx = 0;\n\t    this.__frameCnt = 0;\n\t    this.__delayTimes = null;\n\t    this.__infinity = false;\n\t    this.__loopCnt = 0;\n\t    this.__frames = null;\n\t    this.__textureSrc = null;\n\t  }\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\n\t/**\n\t * \n\t * Gif parser by @gtk2k\n\t * https://github.com/gtk2k/gtk2k.github.io/tree/master/animation_gif\n\t *\n\t */\n\n\texports.parseGIF = function (gif, successCB, errorCB) {\n\n\t  var pos = 0;\n\t  var delayTimes = [];\n\t  var loadCnt = 0;\n\t  var graphicControl = null;\n\t  var imageData = null;\n\t  var frames = [];\n\t  var loopCnt = 0;\n\t  if (gif[0] === 0x47 && gif[1] === 0x49 && gif[2] === 0x46 && // 'GIF'\n\t  gif[3] === 0x38 && gif[4] === 0x39 && gif[5] === 0x61) {\n\t    // '89a'\n\t    pos += 13 + +!!(gif[10] & 0x80) * Math.pow(2, (gif[10] & 0x07) + 1) * 3;\n\t    var gifHeader = gif.subarray(0, pos);\n\t    while (gif[pos] && gif[pos] !== 0x3b) {\n\t      var offset = pos,\n\t          blockId = gif[pos];\n\t      if (blockId === 0x21) {\n\t        var label = gif[++pos];\n\t        if ([0x01, 0xfe, 0xf9, 0xff].indexOf(label) !== -1) {\n\t          label === 0xf9 && delayTimes.push((gif[pos + 3] + (gif[pos + 4] << 8)) * 10);\n\t          label === 0xff && (loopCnt = gif[pos + 15] + (gif[pos + 16] << 8));\n\t          while (gif[++pos]) {\n\t            pos += gif[pos];\n\t          }label === 0xf9 && (graphicControl = gif.subarray(offset, pos + 1));\n\t        } else {\n\t          errorCB && errorCB('parseGIF: unknown label');break;\n\t        }\n\t      } else if (blockId === 0x2c) {\n\t        pos += 9;\n\t        pos += 1 + +!!(gif[pos] & 0x80) * (Math.pow(2, (gif[pos] & 0x07) + 1) * 3);\n\t        while (gif[++pos]) {\n\t          pos += gif[pos];\n\t        }var imageData = gif.subarray(offset, pos + 1);\n\t        frames.push(URL.createObjectURL(new Blob([gifHeader, graphicControl, imageData])));\n\t      } else {\n\t        errorCB && errorCB('parseGIF: unknown blockId');break;\n\t      }\n\t      pos++;\n\t    }\n\t  } else {\n\t    errorCB && errorCB('parseGIF: no GIF89a');\n\t  }\n\t  if (frames.length) {\n\n\t    var cnv = document.createElement('canvas');\n\t    var loadImg = function loadImg() {\n\t      frames.forEach(function (src, i) {\n\t        var img = new Image();\n\t        img.onload = function (e, i) {\n\t          if (i === 0) {\n\t            cnv.width = img.width;\n\t            cnv.height = img.height;\n\t          }\n\t          loadCnt++;\n\t          frames[i] = this;\n\t          if (loadCnt === frames.length) {\n\t            loadCnt = 0;\n\t            imageFix(1);\n\t          }\n\t        }.bind(img, null, i);\n\t        img.src = src;\n\t      });\n\t    };\n\t    var imageFix = function imageFix(i) {\n\t      var img = new Image();\n\t      img.onload = function (e, i) {\n\t        loadCnt++;\n\t        frames[i] = this;\n\t        if (loadCnt === frames.length) {\n\t          cnv = null;\n\t          successCB && successCB(delayTimes, loopCnt, frames);\n\t        } else {\n\t          imageFix(++i);\n\t        }\n\t      }.bind(img);\n\t      img.src = cnv.toDataURL('image/gif');\n\t    };\n\t    loadImg();\n\t  }\n\t};\n\n/***/ }\n/******/ ]);\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","import AssetManager from \"./assetManager\";\nimport \"./components/renderer\";\n\nexport default class AframeContext {\n    constructor(settings) {\n        this.inVR = false;\n        // settings pointer\n        this.settings = settings;\n        this.createScene();\n        // create asset manager\n        this.assetManager = new AssetManager(this.scene);\n    }\n\n    createScene() {\n        // find scene if exists else create scene\n        const scene = document.getElementsByTagName(\"a-scene\");\n        if (scene.length > 0)\n            this.scene = scene[0];\n        else {\n            this.scene = document.createElement(\"a-scene\");\n            document.body.appendChild(this.scene);\n            this.newScene = true;\n        }\n\n        // add stats to scene if debug\n        if (this.settings.debug)\n            this.scene.setAttribute(\"stats\", \"\")\n\n        //custom renderer params like local clipping\n        this.scene.setAttribute(\"vr-renderer\", \"\");\n\n        // check if in VR\n        this.scene.addEventListener(\"enter-vr\", (() => {\n            this.inVR = true;\n        }).bind(this));\n        this.scene.addEventListener(\"exit-vr\", (() => {\n            this.inVR = false;\n        }).bind(this));\n    }\n\n    createContainer(web2vr) {\n        // conttainer for all aframe elements\n        this.container = document.createElement(\"a-entity\");\n        this.container.classList.add(\"vr-container\");\n        this.container.classList.add(this.settings.interactiveTag);\n\n        // position container\n        const width = parseFloat(window.getComputedStyle(web2vr.container).width) * (1 / this.settings.scale);\n        let x = this.settings.position.x;\n        // if x=0 then then we want to be in center for testing and showcase\n        if (x == 0)\n            x = x - width / 2;\n        this.container.object3D.position.set(x, this.settings.position.y, this.settings.position.z);\n        // update rotation from aframe(1.0.4) because there is bug(rotation x will be wrong) if you update with three.js\n        this.container.setAttribute(\"rotation\", { x: this.settings.rotation.x, y: this.settings.rotation.y, z: this.settings.rotation.z });\n\n        const parentElement = document.querySelector(this.settings.parentSelector);\n        if (parentElement)\n            parentElement.appendChild(this.container);\n        else {\n            this.container.setAttribute(\"vr-grab-rotate-static\", \"\");\n            this.container.setAttribute(\"grabbable\", \"\");\n            this.container.setAttribute(\"stretchable\", \"\");\n            this.scene.appendChild(this.container);\n        }\n\n        // pointer for grabRotateStatic\n        this.container.web2vr = web2vr;\n    }\n\n    createControllers() {\n        // event listener for the keyboard key press \n//        document.addEventListener('a-keyboard-update', (e) => {\n//            if (this.keyboard.activeInput) {\n//                const code = parseInt(e.detail.code);\n//                let value = this.keyboard.activeInput.value;\n//\n//                // backspace\n//                if (code == 8)\n//                    value = value.slice(0, -1);\n//                // submit or cancel\n//                else if (code == 6 || code == 24) {\n//                    this.keyboard.object3D.visible = false;\n//                    this.keyboard.object3D.position.y = 10000; // because raycasting still collides with invisible objects\n//                    this.keyboard.activeInput.element.active = false;\n//                    this.keyboard.activeInput.element.update();\n//                    this.keyboard.activeInput = null;\n//                    return;\n//                }\n//                // ignore arrow keys\n//                else if (![37, 38, 39, 40].includes(code))\n//                    value += e.detail.value;\n//\n//                this.keyboard.activeInput.value = value;\n//                this.keyboard.activeInput.element.update();\n//            }\n//        });\n    }\n}\n","export default class AssetManager {\n    constructor(scene) {\n        const assets = document.getElementsByTagName(\"a-assets\")[0];\n        if (assets)\n            this.assets = assets;\n        else {\n            this.assets = document.createElement(\"a-assets\");\n            scene.appendChild(this.assets);\n        }\n    }\n\n    // update current-id attribute\n    updateCurrentAssetId() {\n        let currentAssetId = parseInt(this.assets.getAttribute(\"current-id\"));\n        if (!this.assets.getAttribute(\"current-id\")) {\n            this.assets.setAttribute(\"current-id\", 0);\n            currentAssetId = 0;\n        }\n        this.assets.setAttribute(\"current-id\", currentAssetId + 1);\n    }\n    // update current-id attribute and return it.\n    // used for elements (ex. video) outside a-assets tag\n    updateCurrentAssetIdReturn(){\n        this.updateCurrentAssetId();\n        return \"asset-\"+this.assets.getAttribute(\"current-id\");\n    }\n\n    // find asset if exists if not create and return it\n    getAsset(path, type) {\n        const assets = this.assets.getChildren();\n\n        for (const asset of assets) {\n            if (asset.getAttribute(\"src\") === path)\n                return asset.getAttribute(\"id\");\n        }\n\n        return this.createAsset(path, type);\n    }\n\n    createAsset(path, type) {\n        const asset = document.createElement(type);\n        asset.setAttribute(\"src\", path);\n        this.updateCurrentAssetId();\n        const id = \"asset-\" + this.assets.getAttribute(\"current-id\");\n        asset.setAttribute(\"id\", id);\n        // have to manualy add crossorigin for all external assets to load\n        asset.setAttribute(\"crossorigin\", \"Anonymous\");\n\n        this.assets.appendChild(asset);\n        return id;\n    }\n\n    removeAsset(id) {\n        this.assets.querySelector(\"#\" + id).remove();\n    }\n}","AFRAME.registerComponent(\"vr-animate\", {\n    init: function () {\n        this.running = false;\n        // listenes for css animation and translation\n        this.el.element.domElement.addEventListener(\"animationstart\", this.startAnimation.bind(this));\n        this.el.element.domElement.addEventListener(\"animationend\", this.stopAnimation.bind(this));\n        this.el.element.domElement.addEventListener(\"transitionstart\", this.startAnimation.bind(this));\n        this.el.element.domElement.addEventListener(\"transitionend\", this.stopAnimation.bind(this));\n    },\n    tick: function () {\n        if (this.running)\n            this.el.element.web2vr.update();\n    },\n    startAnimation: function () {\n        this.running = true;\n    },\n    stopAnimation: function () {\n        this.running = false;\n        // one final update\n        this.el.element.web2vr.update();\n    }\n});","AFRAME.registerComponent(\"vr-border\", {\n    schema: {\n        width: { type: \"number\" },\n        color: { type: \"string\" },\n    },\n    init: function () {\n        this.running = true;\n        const plane = this.el.object3D.children[0];\n        const edges = new THREE.EdgesGeometry(plane.geometry);\n        const line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: 0x000000, linewidth: this.data.width }));\n\n        this.borderObject = line;\n        this.el.element.web2vr.aframe.container.object3D.add(this.borderObject);\n\n        //maybe clippingContext inside tick?\n        if (this.el.element.clippingContext) {\n            line.material.clippingPlanes = this.el.element.clippingContext.planes;\n            line.material.needsUpdate = true;\n        }\n    },\n    update: function () {\n        // waiting for three.js(WebGL) to add lineWidth support for Windows(DirectX) browsers for now linewidth is 1 no matter what you set it.\n        // lineWidth works for other OS.\n        const borderWidth = this.data.width;\n\n        // custom element border width\n        if (this.el.element.borderWidth)\n            this.borderObject.material.linewidth = this.el.element.borderWidth;\n        else\n            this.borderObject.material.linewidth = borderWidth;\n\n        // custom element border color\n        if (this.el.element.borderColor)\n            this.borderObject.material.color = this.el.element.borderColor;\n        else\n            this.borderObject.material.color = new THREE.Color(this.data.color);\n    },\n    updateBorder: function () {\n        if (this.el.element.visible) {\n            this.running = true;\n            this.borderObject.material.visible = true;\n        }\n        else\n            this.borderObject.material.visible = false;\n    },\n    tick: function () {\n        if (this.running) {\n            const scale = this.el.object3D.scale;\n            const plane = this.el.object3D.children[0].geometry.clone();\n            plane.scale(scale.x, scale.y, scale.z);\n            const edges = new THREE.EdgesGeometry(plane);\n            const position = this.el.object3D.position;\n\n            this.borderObject.geometry = edges;\n\n            this.borderObject.position.set(position.x, position.y, position.z + this.el.element.web2vr.settings.layerStep * 2);\n            this.running = false;\n        }\n    },\n    remove: function () {\n        this.el.element.web2vr.aframe.container.object3D.remove(this.borderObject);\n    }\n});","AFRAME.registerComponent(\"vr-grab-rotate-static\", {\n    tick: function () {\n        if (this.el.components[\"grabbable\"].grabbed) {\n            // update clipping when moving\n            if (this.el.web2vr.scroll.hasScroll) {\n                for (const element of this.el.web2vr.elements)\n                    element.updateClipping();\n            }\n\n            const obj = this.el.object3D;\n            const hand = this.el.components[\"grabbable\"].grabbers[0].object3D;\n\n            obj.rotation.y = Math.atan2(hand.position.x - (obj.position.x + this.el.children[0].getAttribute(\"width\") / 2), hand.position.z - obj.position.z);\n\n            //obj.rotation.x = hand.rotation.x;\n            //obj.rotation.y = hand.rotation.y;\n            //obj.rotation.z = hand.rotation.z;\n        }\n    },\n});","AFRAME.registerComponent(\"vr-renderer\", {\n    init: function () {\n        this.el.sceneEl.renderer.localClippingEnabled = true;\n    }\n});","AFRAME.registerComponent(\"vr-scrollbar\", {\n    init: function () {\n        this.el.addEventListener(\"click\", (function (evt) {\n            let scrollHeight = parseFloat(this.el.web2vr.aframe.container.firstElementChild.element.style.height) - this.el.web2vr.settings.scrollWindowHeight;\n            if (this.el.web2vr.scroll.scrollContainer == this.el.web2vr.container)\n                scrollHeight = this.el.web2vr.scroll.scrollContainer.scrollHeight - this.el.web2vr.scroll.scrollContainer.clientHeight;\n\n            const scrollY = (1 - evt.detail.intersection.uv.y) * (scrollHeight) / this.el.web2vr.settings.scale;\n            const elements = [...this.el.web2vr.elements];\n            // remove first element that is the backgorund of container\n            elements.shift();\n\n            this.el.pointer.object3D.position.setY(this.pointEndY + evt.detail.intersection.uv.y * (this.pointStartY - this.pointEndY));\n\n            for (const element of elements) {\n                element.position.scrollY = scrollY;\n            }\n            this.el.web2vr.update();\n        }).bind(this));\n    },\n    play: function () {\n        const width = parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute(\"width\"));\n        const height = parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute(\"height\"));\n\n        // init plane size\n        this.el.setAttribute(\"width\", width / 20);\n        this.el.setAttribute(\"height\", height);\n\n        //init scrollbar position\n        this.el.scrollbar.object3D.position.setX(width + parseFloat(this.el.getAttribute(\"width\") / 2));\n        this.el.scrollbar.object3D.position.setY(0 - height / 2); //1.96\n        this.el.scrollbar.object3D.position.setZ(-(this.el.web2vr.settings.layerStep*4));\n\n        // init pointer position and size\n        this.el.pointer.setAttribute(\"height\", width / 20);\n        this.el.pointer.setAttribute(\"width\", width / 20);\n\n        this.pointStartY = height / 2 - parseFloat(this.el.pointer.getAttribute(\"height\")) / 2;\n        this.pointEndY = this.pointStartY - height + parseFloat(this.el.pointer.getAttribute(\"height\"));\n\n        this.el.pointer.object3D.position.setY(this.pointStartY);\n        this.el.pointer.object3D.position.setZ(this.el.web2vr.settings.layerStep*2);\n    }\n\n});","import TextElement from \"./textElement\";\n\nexport default class ButtomElement extends TextElement {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n        this.borderColor = new THREE.Color(0x000000);\n        this.borderWidth = 1;\n    }\n\n    updateTextPadding() {\n        // ignore padding for buttons\n    }\n\n    updateText() {\n        if (this.domElement.tagName == \"INPUT\")\n            this.textValue = this.domElement.value.replace(/\\s{2,}/g, ' ');\n    }\n}","import Element from \"./element\";\n\nexport default class CanvasElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n\n        this.imageId = null;\n        this.entity = document.createElement(\"a-image\");\n    }\n\n    updateImage(src) {\n        const assetId = this.web2vr.aframe.assetManager.getAsset(src, \"img\");\n\n        // remove old image if there is new image\n        if (this.imageId && this.imageId != assetId)\n            this.web2vr.aframe.assetManager.removeAsset(this.imageId);\n\n        this.entity.setAttribute(\"id\", \"IMAGE_\" + assetId);\n        this.entity.setAttribute(\"src\", \"#\" + assetId);\n        this.imageId = assetId;\n    }\n\n    specificUpdate() {\n        this.updateImage(this.domElement.toDataURL());\n    }\n}","import Element from \"./element\";\n\nexport default class CheckBoxElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n        this.borderColor = new THREE.Color(0x000000);\n        this.borderWidth = 1;\n        this.entity = document.createElement(\"a-plane\");\n        this.domElement.addEventListener(\"click\", (() => {\n            this.specificUpdate();\n        }).bind(this))\n    }\n\n    specificUpdate() {\n        if (this.domElement.checked)\n            this.entity.setAttribute(\"color\", \"#0075FF\");\n        else\n            this.entity.setAttribute(\"color\", \"#FFFFFF\");\n    }\n}","import Element from \"./element\";\nimport Helper from \"../utils/helper\";\n\nexport default class ContainerElement extends Element {\n    constructor(web2vr, domElement, layer, textOnly = false) {\n        super(web2vr, domElement, layer);\n        this.textOnly = textOnly;\n        this.entity = document.createElement(\"a-plane\");\n\n        // if hyperlink trigger a click event\n        if (this.domElement.tagName == \"A\") {\n            this.entity.addEventListener(\"click\", () => { console.log(\"Link clicked!\", this.domElement.click()); });\n        }\n\n        if (!this.textOnly) {\n            // show back plane for the main container\n            if (this.domElement == this.web2vr.container)\n                this.entity.setAttribute(\"material\", \"side\", \"double\");\n\n            // only needed for experimental background\n            this.expImageId = null;\n            this.oldBackgroundImage = null;\n            this.oldDomPosition = null;\n        }\n    }\n\n    specificUpdate() {\n        if (!this.textOnly) {\n            const backgroundColor = this.style.backgroundColor;\n            let backgroundImage = this.style.backgroundImage; // to get 1:1 as html have to use background-size: cover; or use experimental\n\n            if (backgroundImage != \"none\") {\n                // cannot use animations that require update to be called every frame. html2canvas is very performance heavy.\n                if (this.web2vr.settings.experimental) {\n                    if ((backgroundImage != this.oldBackgroundImage || (this.oldDomPosition && !this.position.equalsDOMPosition(this.oldDomPosition)))) {\n                        let id = this.domElement.id;\n                        let customId = false;\n                        if (!id) {\n                            customId = true;\n                            id = \"html2canvas-\" + this.web2vr.html2canvasIDcounter++;\n                            this.domElement.id = id;\n                        }\n\n                        html2canvas(this.domElement, {\n                            onclone: (clone) => {\n                                const style = document.createElement('style');\n\n                                clone.head.appendChild(style);\n                                // ignoring opacity because we use opacity from aframe\n                                style.sheet.insertRule(`\n                    #${id} {\n                        opacity: 1;\n                    }`);\n                                // hide the text\n                                style.sheet.insertRule(`\n                    #${id} {\n                        color: transparent;\n                    }`);\n                                // hide the children elements\n                                style.sheet.insertRule(`\n                    #${id} > * {\n                        display:none\n                    }`);\n                                // vr-span has to be block so it can render properly\n                                style.sheet.insertRule(`\n                    #${id} > .vr-span {\n                        display:block\n                    }`);\n                                if (customId)\n                                    this.domElement.removeAttribute(\"id\");\n                            }\n                        }).then(canvas => {\n                            if (this.expImageId)\n                                this.web2vr.aframe.assetManager.removeAsset(this.expImageId);\n                            this.expImageId = this.web2vr.aframe.assetManager.getAsset(canvas.toDataURL(), \"img\");\n                            this.entity.setAttribute(\"material\", \"src: #\" + this.expImageId);\n                        });\n                        this.oldBackgroundImage = backgroundImage;\n                    }\n                }\n                else if (Helper.isUrl(backgroundImage)) {\n                    // remove url(\"\")\n                    backgroundImage = backgroundImage.substring(backgroundImage.lastIndexOf('(\\\"') + 2, backgroundImage.lastIndexOf('\\\")'));\n                    this.entity.setAttribute(\"material\", \"src: #\" + this.web2vr.aframe.assetManager.getAsset(backgroundImage, \"img\"));\n                    // transparent images support\n                    this.entity.setAttribute(\"material\", \"transparent\", true);\n                }\n            }\n            else {\n                // if there is no backgroundColor dont renders\n                if (backgroundColor == \"rgba(0, 0, 0, 0)\") {\n                    this.entity.setAttribute(\"material\", \"visible\", false);\n                }\n                else {\n                    this.entity.setAttribute(\"material\", \"visible\", true);\n                    this.entity.setAttribute(\"color\", backgroundColor);\n                    this.updateOpacity();\n                }\n            }\n            this.oldDomPosition = this.position.domPosition;\n        }\n    }\n\n    updateOpacity() {\n        const alpha = parseFloat(this.style.backgroundColor.split(',')[3]);\n        // calculate final alpha channel result\n        if (alpha) {\n            let a = alpha;\n            let b = this.style.opacity;\n            if (a < b) {\n                b = alpha;\n                a = this.style.opacity;\n            }\n            this.entity.setAttribute(\"opacity\", a - (a - b));\n        }\n    }\n}","import Position from \"../utils/position\";\nimport MouseEventHandler from \"../utils/mouseEventHandler\";\n\nexport default class Element {\n    constructor(web2vr, domElement, layer) {\n        this.web2vr = web2vr;\n        this.domElement = domElement;\n        this.layer = layer;\n        this.domElement.element = this; // so we can do domeElement.parentNode.element\n        this.childElements = new Set();\n\n        this.entity = null; // aframe entity this null becasue Element class is abstract\n        this.visible = true;\n        if (this.domElement.classList.contains(\"vr-span\"))\n            this.paddingToMargin();\n        this.position = new Position(this.domElement.getBoundingClientRect(), layer * this.web2vr.settings.layerStep, web2vr.settings.scale);\n        this.style = window.getComputedStyle(this.domElement);\n        this.parentTransform = \"none\";\n        this.needsStartingTransformSize = true;\n    }\n\n    // call after entity is created in inheriting class\n    initEventHandlers() {\n        this.initHover();\n\n        // setting up MouseEventHandler\n        this.mouseEventHandle = new MouseEventHandler(this);\n\n        // dynamic listeners\n        this.domElement.addEventListener(\"eventListenerAdded\", () => this.mouseEventHandle.resync());\n        this.domElement.addEventListener(\"eventListenerRemoved\", () => this.mouseEventHandle.resync());\n    }\n\n    // add animation compoment if dom element has animation\n    checkAnimation() {\n        if (parseFloat(this.style.animationDuration) || parseFloat(this.style.transitionDuration))\n            this.entity.setAttribute(\"vr-animate\", \"\");\n        else\n            this.entity.removeAttribute(\"vr-animate\");\n    }\n\n    initHover() {\n        // find what has hover\n        let tag = null;\n        if (this.web2vr.hoverSelectors.has(this.domElement.tagName.toLowerCase()))\n            tag = this.domElement.tagName.toLowerCase();\n        let classes = [];\n        for (const cls of this.domElement.classList) {\n            if (this.web2vr.hoverSelectors.has(\".\" + cls))\n                classes.push(cls);\n        }\n        let id = null;\n        if (this.web2vr.hoverSelectors.has(\"#\" + this.domElement.id))\n            id = this.domElement.id;\n\n        // add mouseenter and mouseleave if element has hover.\n        if (tag || classes.length > 0 || id) {\n            this.entity.addEventListener(\"mouseenter\", () => {\n                if (tag)\n                    this.domElement.classList.add(tag + \"hover\");\n                if (classes.length > 0)\n                    for (const cls of classes)\n                        this.domElement.classList.add(cls + \"hover\");\n                if (id)\n                    this.domElement.classList.add(id + \"hover\");\n                // this is only for hover transform. Update all elements when transform gets added\n                if (this.style.transform != \"none\") {\n                    this.web2vr.update();\n                    this.hoverTransform = true;\n                }\n\n            });\n            this.entity.addEventListener(\"mouseleave\", () => {\n                if (tag)\n                    this.domElement.classList.remove(tag + \"hover\");\n                if (classes.length > 0)\n                    for (const cls of classes)\n                        this.domElement.classList.remove(cls + \"hover\");\n                if (id)\n                    this.domElement.classList.remove(id + \"hover\");\n                if (this.hoverTransform) {\n                    this.position.depth = this.position.startDepth;\n                    for (const element of this.domElement.querySelectorAll('*')) {\n                        if (element.element) {\n                            element.element.parentTransform = \"none\";\n                            element.element.position.depth = element.element.position.startDepth;\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    // getBoundingClientRect works great with margin while with padding it has problems with paddingRight that needs to be manualy calculated and set\n    // because dealing with paddingRight is problematic we can make the padding be margin for the textNode(vr-span)\n    paddingToMargin() {\n        // only if element has text\n        if (this.domElement.textContent.trim()) {\n            //const left = this.domElement.parentElement.element.style.paddingLeft;\n            const right = this.domElement.parentElement.element.style.paddingRight;\n            //const top = this.domElement.parentElement.element.style.paddingTop;\n            //const bottom = this.domElement.parentElement.element.style.paddingBottom;\n\n            /*if (parseFloat(left)) {\n                this.domElement.style.marginLeft = left;\n                this.domElement.parentElement.style.paddingLeft = \"0px\";\n            }*/\n            if (parseFloat(right)) {\n                this.domElement.style.marginRight = right;\n                this.domElement.parentElement.style.paddingRight = \"0px\";\n            }\n            /*if (parseFloat(top)) {\n                this.domElement.style.marginTop = top;\n                //this.domElement.parentElement.style.paddingTop = \"0px\";\n            }\n            if (parseFloat(bottom)) {\n                this.domElement.style.marginBottom = bottom;\n                //this.domElement.parentElement.style.paddingBottom = \"0px\";\n            }*/\n        }\n    }\n\n    init() {\n        // reference of the element for aframe compoment\n        this.entity.element = this;\n\n        // dont need light to affect material\n        this.entity.setAttribute(\"material\", \"shader\", \"flat\");\n\n        //init sizes at start\n        this.entity.setAttribute(\"width\", this.position.width);\n        this.entity.setAttribute(\"height\", this.position.height);\n\n        this.initEventHandlers();\n\n        this.setupClipping();\n    }\n\n    update() {\n        const clientRect = this.domElement.getBoundingClientRect();\n\n        // its not on the screen\n        if (clientRect.width == 0 || clientRect.height == 0) {\n            this.entity.object3D.visible = false;\n            if (!this.domElement.classList.contains(\"vr-span\"))\n                this.entity.classList.remove(this.web2vr.settings.interactiveTag);\n            this.position.aframePosition.y = 1000; // for some reason raycast still hits so have to move position\n            return;\n        }\n\n        // for future move this in TextElement class\n        if (this.domElement.classList.contains(\"vr-span\")) {\n            // dont need interaction with the text when we always have the background as interaction\n            this.entity.classList.remove(this.web2vr.settings.interactiveTag);\n            // so all inline text width is good, dont do this if its text inside button\n            if (this.domElement.parentElement.tagName != \"BUTTON\") {\n                clientRect.width += 8;\n                clientRect.x -= 2;\n            }\n        }\n\n        // set fixed container height if its using scrollBody, best is to move this code outside update loop for future\n        if (this.web2vr.scroll.hasScroll && this.domElement == this.web2vr.container && this.web2vr.scroll.scrollBody)\n            clientRect.height = this.web2vr.settings.scrollWindowHeight;\n        this.position.updatePosition(clientRect);\n\n        this.checkVisible();\n        if (this.visible) {\n            this.style = window.getComputedStyle(this.domElement);\n\n            // its on visible screen but its hidden by style\n            if (this.style.visibility === \"hidden\" || this.style.display === \"none\") {\n                this.entity.object3D.visible = false;\n                if (!this.domElement.classList.contains(\"vr-span\"))\n                    this.entity.classList.remove(this.web2vr.settings.interactiveTag);\n                this.position.aframePosition.y = 1000; // for some reason raycast still hits so have to move position\n                // update border so we can remove it because element is hidden\n                this.updateBorder();\n                return;\n            }\n            else {\n                this.entity.object3D.visible = true;\n                // for input text because it has custom event for entity it cannot detect with this.mouseEventHandle.listeningForMouseEvents\n                // we have to check tagName and type to see if its input text, for future make this work with mouseEventHandle\n                // also add interactiveTag if its main container\n                if ((!this.domElement.classList.contains(\"vr-span\") && (this.mouseEventHandle.listeningForMouseEvents || (this.domElement.tagName == \"INPUT\" && this.domElement.type == \"text\")) || this.domElement == this.web2vr.container))\n                    this.entity.classList.add(this.web2vr.settings.interactiveTag);\n            }\n\n            // if there is transform then width and height will be set with the transform matrix scale\n            // using needsStartingTransformSize so width and height are never 0 when doing transform scale\n            if (this.style.transform == \"none\" || this.needsStartingTransformSize) {\n                this.entity.setAttribute(\"width\", this.position.width);\n                this.entity.setAttribute(\"height\", this.position.height);\n            }\n\n            this.checkAnimation();\n\n            const opacity = this.style.opacity;\n            this.entity.setAttribute(\"opacity\", opacity);\n\n            this.specificUpdate();\n            this.updateTransform();\n            this.updateClipping();\n        }\n        this.updateBorder();\n    }\n\n    updateTransform() {\n\n        let transform = this.style.transform;\n        if (transform == \"none\")\n            transform = this.parentTransform;\n        else {\n            // give transform to all descendents\n            for (const element of this.domElement.querySelectorAll('*')) {\n                if (element.element)\n                    element.element.parentTransform = transform;\n            }\n        }\n\n        if (transform != \"none\") {\n            this.needsStartingTransformSize = false;\n            const matrixType = transform.split('(')[0];\n            // get matrix values in float\n            let values = transform.split('(')[1];\n            values = values.split(')')[0];\n            values = values.split(',');\n            values = values.map(v => parseFloat(v));\n            let matrix = null;\n\n            if (matrixType == \"matrix\") {\n                // transform to matrix4x4 and invert skewX to match three.js\n                matrix = new THREE.Matrix4().fromArray([values[0], values[1], 0, 0, -values[2], values[3], 0, 0, 0, 0, 1, 0, values[4], values[5], 0, 1]);\n            }\n            else if (matrixType == \"matrix3d\") {\n                // invert skewX and skewZ? to match three.js\n                values[4] *= -1;\n                values[9] *= -1;\n                matrix = new THREE.Matrix4().fromArray(values);\n            }\n            const position = new THREE.Vector3();\n            const quaternion = new THREE.Quaternion();\n            const scale = new THREE.Vector3();\n            matrix.decompose(position, quaternion, scale);\n\n            // position\n            this.position.domPosition.x += position.x;\n            this.position.domPosition.y += position.y;\n            if (position.z != 0)\n                this.position.depth = position.z * this.position.scalingFactor + this.position.startDepth;\n\n            // rotation\n            this.entity.object3D.rotation.setFromRotationMatrix(matrix);\n\n            // calcualte scale and set it to entity\n            if (this.parentTransform == \"none\") {\n                const elements = matrix.elements;\n                const scaleX = Math.sqrt(elements[0] * elements[0] + elements[1] * elements[1]);\n                const scaleY = Math.sqrt(elements[5] * elements[5] + elements[4] * elements[4]);\n                // for radio scale is 2 times smaller because its circle, for some rason checkbox scale needs to be in half else its too big\n                if (this.domElement.tagName == \"INPUT\" && (this.domElement.type == \"radio\" || this.domElement.type == \"checkbox\"))\n                    this.entity.object3D.scale.set(scaleX / 2, scaleY / 2, 1);\n                else\n                    this.entity.object3D.scale.set(scaleX, scaleY, 1);\n            }\n        }\n        this.entity.object3D.position.set(this.position.x, this.position.y, this.position.z);\n    }\n\n    // abstract method\n    specificUpdate() {\n\n    }\n\n    updateBorder() {\n        if (this.web2vr.settings.border) {\n            // using borderTopWidth and borderTopColor because borderWidth and borderColor doesnt work in firefox\n            const borderWidth = parseFloat(this.style.borderTopWidth);\n            if ((borderWidth || this.borderWidth) && this.entity.object3D.visible) {\n                this.entity.setAttribute(\"vr-border\", `width:${borderWidth}; color:${this.style.borderTopColor};`);\n                this.entity.components[\"vr-border\"].updateBorder();\n            }\n            else if (this.entity.components[\"vr-border\"])\n                this.entity.removeAttribute(\"vr-border\");\n        }\n    }\n\n    rotateNormal(normal) {\n        const normalMatrix = new THREE.Matrix3().getNormalMatrix(this.web2vr.aframe.container.object3D.matrixWorld);\n        const output = normal.clone().applyMatrix3(normalMatrix).normalize();\n        return output;\n    }\n\n    getClippingContext() {\n        let output = null;\n\n        if (this.domElement.parentNode && this.domElement.parentNode.element && this.domElement.parentNode.element.clippingContext)\n            output = this.domElement.parentNode.element.clippingContext;\n        else {\n            if ((this.style.overflow && this.style.overflow == \"hidden\") || (this.web2vr.scroll.hasScroll && this.domElement == this.web2vr.container) || (this.web2vr.settings.forceClipping && this.domElement == this.web2vr.container)) {\n                // ignore if its svg\n                if (this.domElement.tagName != \"svg\") {\n                    let clippingContext = {};\n                    clippingContext.authority = this;\n\n                    clippingContext.bottom = new THREE.Plane(this.rotateNormal(new THREE.Vector3(0, 1, 0))); // normal up\n                    clippingContext.top = new THREE.Plane(this.rotateNormal(new THREE.Vector3(0, -1, 0))); // normal down\n                    clippingContext.left = new THREE.Plane(this.rotateNormal(new THREE.Vector3(1, 0, 0))); // normal right\n                    clippingContext.right = new THREE.Plane(this.rotateNormal(new THREE.Vector3(-1, 0, 0))); // normal left\n\n                    clippingContext.planes = [clippingContext.bottom, clippingContext.top, clippingContext.left, clippingContext.right];\n\n                    output = clippingContext;\n                }\n            }\n        }\n        return output;\n    }\n\n    setupClipping() {\n        const clippingContext = this.getClippingContext();\n\n        if (clippingContext) {\n            this.clippingContext = clippingContext;\n\n            // we are sure the renderer is loaded\n            const object3D = this.entity.object3D;\n            if (!object3D || !object3D.children || !object3D.children.length > 0 || !object3D.children[0].material) {\n                return;\n            }\n\n            const material = object3D.children[0].material;\n            material.clippingPlanes = clippingContext.planes;\n\n            //this.updateClipping();\n            setTimeout(() => { this.updateClipping(); }, 200); // if it doesnt work use this\n        }\n    }\n\n    updateClipping() {\n        // only element with authority can change the clipping planes position\n        if (!this.clippingContext || this.clippingContext.authority != this)\n            return;\n\n        const position = this.entity.object3D.position;\n\n        const bottomLocal = position.clone().add((new THREE.Vector3(0, -1, 0)).multiplyScalar(this.position.height / 2));\n        const topLocal = position.clone().add((new THREE.Vector3(0, 1, 0)).multiplyScalar(this.position.height / 2));\n        const leftLocal = position.clone().add((new THREE.Vector3(-1, 0, 0)).multiplyScalar(this.position.width / 2));\n        const rightLocal = position.clone().add((new THREE.Vector3(1, 0, 0)).multiplyScalar(this.position.width / 2));\n\n        const bottomGlobal = this.web2vr.aframe.container.object3D.localToWorld(bottomLocal.clone());\n        const topGlobal = this.web2vr.aframe.container.object3D.localToWorld(topLocal.clone());\n        const leftGlobal = this.web2vr.aframe.container.object3D.localToWorld(leftLocal.clone());\n        const rightGlobal = this.web2vr.aframe.container.object3D.localToWorld(rightLocal.clone());\n\n        this.clippingContext.bottom.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0, 1, 0)), bottomGlobal).normalize();\n        this.clippingContext.top.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0, -1, 0)), topGlobal).normalize();\n        this.clippingContext.left.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(1, 0, 0)), leftGlobal).normalize();\n        this.clippingContext.right.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(-1, 0, 0)), rightGlobal).normalize();\n\n        if (this.web2vr.settings.showClipping) {\n            if (!this.clippingPlaneHelpers) {\n                this.clippingPlaneHelpers = [];\n\n                for (const plane of this.clippingContext.planes) {\n                    const material = new THREE.MeshBasicMaterial({ color: 0x00e33d, side: THREE.DoubleSide });\n                    const geometry = new THREE.PlaneGeometry(200 * this.position.scalingFactor, 200 * this.position.scalingFactor); // no need same width and height as container because this is only for debugging\n                    const mesh = new THREE.Mesh(geometry, material);\n\n                    mesh.debugPlane = plane;\n                    this.clippingPlaneHelpers.push(mesh);\n\n                    const axisHelper = new THREE.AxesHelper(5);\n                    mesh.add(axisHelper);\n                }\n\n                for (const helper of this.clippingPlaneHelpers) {\n                    this.web2vr.aframe.scene.object3D.add(helper);\n                }\n            }\n            for (const mesh of this.clippingPlaneHelpers) {\n                mesh.visible = true;\n\n                const worldPos = new THREE.Vector3();\n                this.entity.object3D.getWorldPosition(worldPos);\n                const point = new THREE.Vector3();\n                mesh.debugPlane.projectPoint(worldPos, point);\n                mesh.position.set(point.x, point.y, point.z);\n\n                // clipping plane normals are inverted, we multiply by -1\n                const focalPoint = point.clone().add(mesh.debugPlane.normal.clone().multiplyScalar(-1));\n                mesh.lookAt(focalPoint);\n            }\n\n        }\n        else {\n            if (this.clippingPlaneHelpers) {\n                for (const mesh of this.clippingPlaneHelpers)\n                    mesh.visible = false;\n            }\n        }\n    }\n\n    checkVisible() {\n        if (this.clippingContext) {\n            const container = this.clippingContext.authority;\n            if (this.position.bottom.y > container.position.top.y || this.position.top.y < container.position.bottom.y) {\n                this.visible = false;\n                this.entity.object3D.visible = false;\n                // remove interactive tag\n                if (!this.domElement.classList.contains(\"vr-span\"))\n                    this.entity.classList.remove(this.web2vr.settings.interactiveTag);\n            }\n            else {\n                this.visible = true;\n                this.entity.object3D.visible = true;\n                // interactive tag so we can do raycasting if it has mouse events or its container background\n                if ((!this.domElement.classList.contains(\"vr-span\") && this.mouseEventHandle.listeningForMouseEvents) || this.domElement == this.web2vr.container)\n                    this.entity.classList.add(this.web2vr.settings.interactiveTag);\n            }\n        }\n    }\n}","import Element from \"./element\";\n\nexport default class ImageElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n\n        this.currentSrc = null;\n        this.changed = false;\n        this.entity = document.createElement(\"a-image\");\n        this.entity.setAttribute(\"material\", \"side\", \"front\");\n        // know when image is loaded\n        this.loaded = false;\n        this.domElement.addEventListener(\"load\", () => {\n            this.loaded = true;\n            // if image changed update all after image loaded\n            if (this.changed) {\n                this.changed = false;\n                this.web2vr.update();\n            }\n        });\n    }\n    updateImage(src) {\n        const assetID = this.web2vr.aframe.assetManager.getAsset(src, \"img\");\n        this.entity.setAttribute(\"id\", \"IMAGE_\" + assetID);\n\n        const isGif = /\\.(gif)$/i;\n        if (isGif.test(src)) {\n            this.entity.setAttribute(\"material\", \"shader\", \"gif\");\n            this.entity.setAttribute(\"material\", \"src\", \"#\" + assetID);\n        }\n        else {\n            this.entity.setAttribute(\"material\", \"shader\", \"flat\");\n            this.entity.setAttribute(\"src\", \"#\" + assetID);\n        }\n    }\n\n    specificUpdate() {\n        const src = this.domElement.getAttribute(\"src\");\n        if (src != this.currentSrc) {\n            if (this.currentSrc) {\n                this.loaded = false;\n                this.changed = true;\n            }\n            this.currentSrc = src;\n            this.updateImage(this.currentSrc);\n        }\n    }\n}\n\n// TODO: No need to save image copy in assets you can directly read it from the orignal","import TextElement from \"./textElement\";\n\nexport default class InputElement extends TextElement {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n        this.borderColor = new THREE.Color(0x000000);\n        this.borderWidth = 1;\n        this.active = false;\n\n        // update when there is change of value\n        this.domElement.addEventListener(\"input\", () => this.update());\n        // when clicked make it active input for the keyboard and position the keyboard relative to camera\n        this.entity.addEventListener(\"click\", () => {\n          document.querySelector(\"a-scene\").emit(\"element-input-click\",  this)\n        })\n    }\n\n    updateText() {\n        const value = this.domElement.value;\n        if (value)\n            this.textValue = value;\n        else\n            this.textValue = this.domElement.placeholder;\n    }\n    updateTextColor() {\n        const value = this.domElement.value;\n        if (value)\n            super.updateTextColor();\n        else\n            this.entity.setAttribute(\"text\", \"color\", \"#999\");\n\n        if (this.active)\n            this.entity.setAttribute(\"color\", \"#ffffcc\");\n    }\n}\n","import Element from \"./element\";\n\nexport default class RadioElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n        this.borderColor = new THREE.Color(0x000000);\n        this.borderWidth = 1;\n        this.entity = document.createElement(\"a-circle\");\n        this.domElement.addEventListener(\"click\", (() => {\n            this.web2vr.update();\n        }).bind(this));\n    }\n\n    specificUpdate() {\n        this.entity.setAttribute(\"radius\", this.position.width / 2);\n        \n            if (this.domElement.checked)\n                this.entity.setAttribute(\"color\", \"#0075FF\");\n            else\n                this.entity.setAttribute(\"color\", \"#FFFFFF\");\n        }\n    }","import Element from \"./element\";\n\nexport default class SvgElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n\n        this.imageId = null;\n        this.entity = document.createElement(\"a-image\");\n    }\n\n    svgToImage() {\n        const svgString = new XMLSerializer().serializeToString(this.domElement);\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = this.position.domPosition.width * 2;\n        canvas.height = this.position.domPosition.height * 2;\n\n        const DOMURL = self.URL || self.webkitURL || self;\n        const img = new Image();\n        const svg = new Blob([svgString], { type: \"image/svg+xml;charset=utf-8\" });\n        const url = DOMURL.createObjectURL(svg);\n\n        img.onload = () => {\n            if (this.domElement.style.width)\n                ctx.drawImage(img, 0, 0, canvas.width*2, canvas.height*2);\n            else\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n            DOMURL.revokeObjectURL(url);\n            this.updateImage(canvas.toDataURL());\n            canvas.remove();\n        };\n        img.src = url;\n    }\n    updateImage(src) {\n        const assetId = this.web2vr.aframe.assetManager.getAsset(src, \"img\");\n\n        // remove old image if there is new image\n        if (this.imageId && this.imageId != assetId)\n            this.web2vr.aframe.assetManager.removeAsset(this.imageId);\n\n        this.entity.setAttribute(\"id\", \"IMAGE_\" + assetId);\n        this.entity.setAttribute(\"src\", \"#\" + assetId);\n        this.imageId = assetId;\n    }\n\n    specificUpdate() {\n        this.svgToImage();\n    }\n}","import ContainerElement from \"./containerElement\";\n\nexport default class TextElement extends ContainerElement {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer, false);\n\n        this.entity.setAttribute(\"text\", \"value\", \"\");\n        this.textValue = null;\n    }\n\n    setupClipping() {\n        let clippingContext = this.getClippingContext();\n\n        if (clippingContext) {\n            this.clippingContext = clippingContext;\n\n            let material = this.entity.components.text.material;\n\n            // text component uses custom shader so default three.js clipping doesnt work, needed to inject clipping shader code inside the custom shader code(RawShaderMaterial)\n            // help from https://stackoverflow.com/questions/42532545/add-clipping-to-three-shadermaterial\n            // 1.1.0 version changes: Because Aframe 1.1.0 changes text material shader to use webgl 2(glsl 3) some of the three.js ShaderChunk had to be converted to glsl 3.\n            const fragmentShader = `#version 300 es\n            precision highp float;\n            uniform bool negate;\n            uniform float alphaTest;\n            uniform float opacity;\n            uniform sampler2D map;\n            uniform vec3 color;\n            in vec2 vUV;\n            out vec4 fragColor;\n            float median(float r, float g, float b) {\n                return max(min(r, g), min(max(r, g), b));\n            }\n            #define BIG_ENOUGH 0.001\n            #define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\n            \n            // clipping_planes_pars_fragment converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n                in vec3 vClipPosition;\n                uniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n            #endif\n            \n            void main() {\n                // compatible with glsl 3\n                #include <clipping_planes_fragment>\n\n                vec3 sampleColor = texture(map, vUV).rgb;\n                if (negate) { sampleColor = 1.0 - sampleColor; }\n                float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n                float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n                float dscale = 0.353505;\n                vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));\n                float isBigEnough = max(abs(duv.x), abs(duv.y));\n                // Do modified alpha test.\n                if (isBigEnough > BIG_ENOUGH) {\n                    float ratio = BIG_ENOUGH / isBigEnough;\n                    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n                }\n                // Do modified alpha test.\n                if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n                fragColor = vec4(color.xyz, alpha * opacity);\n            }`;\n\n            const vertexShader = `#version 300 es\n            in vec2 uv;\n            in vec3 position;\n            uniform mat4 projectionMatrix;\n            uniform mat4 modelViewMatrix;\n            out vec2 vUV;\n\n            // clipping_planes_pars_vertex converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n\t            out vec3 vClipPosition;\n            #endif\n\n            void main(void) {\n                // compatible with glsl 3\n                #include <begin_vertex>\n\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                vUV = uv;\n\n                // compatible with glsl 3\n                #include <project_vertex>\n                #include <clipping_planes_vertex>\n\n            }`;\n\n            material.fragmentShader = fragmentShader;\n            material.vertexShader = vertexShader;\n            material.clipping = true;\n            material.clippingPlanes = clippingContext.planes;\n\n            this.updateClipping();\n        }\n    }\n\n    updateTextAlignment() {\n        // align css text-align to text component\n        let align = this.style.textAlign;\n        if (![\"left\", \"right\", \"center\"].includes(align))\n            align = \"left\";\n        this.entity.setAttribute(\"text\", \"align\", align);\n\n        // set text lineHeight if it has custom css lineHeight\n        const text = this.entity.components.text;\n        if (this.style.lineHeight != \"normal\" && (typeof text.currentFont != \"undefined\")) {\n            this.entity.setAttribute(\"text\", \"lineHeight\", text.currentFont.common.lineHeight + parseFloat(this.style.lineHeight));\n        }\n    }\n\n    updateTextSize() {\n        const actualFontSize = parseFloat(this.style.fontSize);\n        const width = this.position.width;\n\n        const widthInPixels = width / this.position.scalingFactor;\n        let wrapPixels = widthInPixels * 42 / actualFontSize;\n        wrapPixels *= 1.107; //1.10706774183070233\n        this.entity.setAttribute(\"text\", \"wrapPixels\", wrapPixels);\n        this.entity.setAttribute(\"text\", \"width\", width);\n    }\n\n    updateTextColor() {\n        // opacity from parent because it doesnt pass it to children\n        const opacity = this.domElement.parentElement.element.style.opacity;\n        this.entity.setAttribute(\"text\", \"opacity\", opacity);\n\n        const textColor = this.style.color;\n        this.entity.setAttribute(\"text\", \"color\", textColor);\n    }\n\n    updateText() {\n        // remove new lines and whitespaces\n        this.textValue = this.domElement.textContent.replace(/\\s{2,}/g, ' ');\n    }\n\n    specificUpdate() {\n        super.specificUpdate();\n\n        this.updateTextSize();\n        this.updateTextAlignment();\n        this.updateText();\n        this.entity.setAttribute(\"text\", \"value\", this.textValue);\n        this.updateTextColor();\n    }\n}","import Element from \"./element\";\n\nexport default class VideoElement extends Element {\n    constructor(web2vr, domElement, layer) {\n        super(web2vr, domElement, layer);\n        // normal video\n        this.entity = document.createElement(\"a-video\");\n        // 360 video\n        this.video360 = document.createElement(\"a-videosphere\");\n        this.web2vr.aframe.scene.appendChild(this.video360);\n\n        this.createClickEvent();\n\n        this.domElement.addEventListener(\"play\", () => {\n            if (this.domElement.hasAttribute(\"vr\"))\n                this.video360.components.material.material.map.image.play();\n        });\n\n        this.domElement.addEventListener(\"pause\", () => {\n            if (this.domElement.hasAttribute(\"vr\"))\n                this.video360.components.material.material.map.image.pause();\n        });\n    }\n\n    createClickEvent() {\n        // for normal video\n        this.domElement.addEventListener(\"click\", () => {\n            this.domElement.paused ? this.domElement.play() : this.domElement.pause();\n        });\n    }\n\n    specificUpdate() {\n        const src = this.domElement.currentSrc;\n        let id = this.domElement.id;\n\n        // if there is no video id generate new id\n        if(!id){\n            id = this.web2vr.aframe.assetManager.updateCurrentAssetIdReturn();\n            this.domElement.id = id;\n        }\n\n        if (this.domElement.hasAttribute(\"vr\")) {\n            this.video360.object3D.visible = true;\n            this.video360.classList.add(this.web2vr.settings.interactiveTag);\n            this.entity.object3D.visible = false;\n            this.entity.classList.remove(this.web2vr.settings.interactiveTag);\n\n            this.video360.setAttribute(\"src\", \"#\" + id);\n            // set video360 rotation\n            const rotation = this.domElement.getAttribute(\"vr\");\n            if (rotation)\n                this.video360.object3D.rotation.y = THREE.Math.degToRad(rotation);\n            else\n                this.video360.object3D.rotation.y = 0;\n        }\n        else {\n            this.video360.object3D.visible = false;\n            this.video360.classList.remove(this.web2vr.settings.interactiveTag);\n            this.entity.object3D.visible = true;\n            this.entity.classList.add(this.web2vr.settings.interactiveTag);\n\n            this.entity.setAttribute(\"src\", \"#\" + id);\n        }\n    }\n}","// https://gist.github.com/stringparser/a3b0555fd915138a0ed3 edited version from DOM2AFrame\n;[Element].forEach(function (self) {\n\n  //self.prototype.eventListenerList = {}; // shared STATIC object across all instances... NOT what we want\n  self.prototype._addEventListener = self.prototype.addEventListener;\n  self.prototype.addEventListener = function (type, handle, useCapture) {\n\n    if (!this.eventListenerList)\n      this.eventListenerList = {};\n\n    useCapture = useCapture === void 0 ? false : useCapture;\n    var node = this;\n\n    node._addEventListener(type, handle, useCapture);\n    if (!node.eventListenerList[type]) {\n      node.eventListenerList[type] = [];\n    }\n\n    node.eventListenerList[type].push({\n      type: type,\n      handle: handle,\n      useCapture: useCapture,\n      remove: function () {\n        node.removeEventListener(\n          this.type, this.handle, this.useCapture\n        );\n        return node.eventListenerList[type];\n      }\n    });\n\n    if (type != \"eventListenerAdded\" && type != \"eventListenerRemoved\") {\n      let eventDetail = {\n        'type': type,\n        'handle': handle,\n        'useCapture': useCapture\n      };\n      let addedEvent = new CustomEvent(\"eventListenerAdded\", { detail: eventDetail });\n      this.dispatchEvent(addedEvent);\n    }\n  };\n\n\n  self.prototype._removeEventListener = self.prototype.removeEventListener;\n  self.prototype.removeEventListener = function (type, handle, useCapture) {\n\n    if (!this.eventListenerList)\n      this.eventListenerList = {};\n\n    var node = this;\n    if (!node.eventListenerList[type])\n      return;\n\n    node._removeEventListener(type, handle, useCapture);\n    node.eventListenerList[type] = node.eventListenerList[type].filter(\n      function (listener) {\n        return listener && listener.handle && handle && (listener.handle.toString() !== handle.toString()); // native event listener API supports empty handles/listeners, but .toString obviously doesn't\n      }\n    )\n\n    if (node.eventListenerList[type].length === 0) {\n      delete node.eventListenerList[type];\n    }\n\n\n    if (type != \"eventListenerAdded\" && type != \"eventListenerRemoved\") {\n      let eventDetail = {\n        'type': type,\n        'handle': handle,\n        'useCapture': useCapture\n      };\n      let removedEvent = new CustomEvent(\"eventListenerRemoved\", { detail: eventDetail });\n      this.dispatchEvent(removedEvent);\n    }\n  }\n});","import \"./components/scrollbar\";\nexport default class Scroll {\n    constructor(web2vr) {\n        this.web2vr = web2vr;\n\n        this.hasScroll = false;\n        this.scrollBody = false;\n        this.scrollContainer = null;\n        if (this.web2vr.settings.scroll) {\n            this.checkScrollbar();\n            if (this.hasScroll)\n                this.createScrollbar();\n        }\n    }\n\n    checkScrollbar() {\n        // entire body scroll\n        const body = document.scrollingElement;\n        // div container scroll\n        const container = this.web2vr.container;\n\n        if (body.scrollHeight > body.clientHeight) {\n            this.hasScroll = true;\n            this.scrollContainer = body;\n            this.scrollBody = true;\n        }\n        else if (container.element.style.overflow == \"scroll\") { //container.scrollHeight > container.clientHeight\n            this.hasScroll = true;\n            this.scrollContainer = container;\n        }\n    }\n\n    createScrollbar() {\n        this.scrollbar = document.createElement(\"a-entity\");\n\n        this.pointer = document.createElement(\"a-plane\");\n        this.pointer.setAttribute(\"material\", \"shader\", \"flat\");\n        this.pointer.setAttribute(\"color\", \"#C1C1C1\");\n\n        this.plane = document.createElement(\"a-plane\");\n        this.plane.setAttribute(\"material\", \"shader\", \"flat\");\n        this.plane.setAttribute(\"material\", \"side\", \"double\");\n        this.plane.classList.add(this.web2vr.settings.interactiveTag);\n        this.plane.setAttribute(\"color\", \"#F1F1F1\");\n        this.plane.setAttribute(\"width\", 1);\n        this.plane.setAttribute(\"vr-scrollbar\", \"\");\n\n        // pointers for scroll compoment\n        this.plane.web2vr = this.web2vr;\n        this.plane.pointer = this.pointer;\n        this.plane.scrollbar = this.scrollbar;\n\n        this.plane.appendChild(this.pointer);\n        this.scrollbar.appendChild(this.plane);\n        this.web2vr.aframe.container.appendChild(this.scrollbar);\n    }\n\n    update() {\n        // there is no need to show scrollbar if the main container is hidden\n        if (this.hasScroll) {\n            if (this.web2vr.container.element.style.visibility == \"visible\") {\n                this.scrollbar.object3D.visible = true;\n                this.plane.classList.add(this.web2vr.settings.interactiveTag);\n            }\n            else if (this.web2vr.container.element.style.visibility == \"hidden\") {\n                this.scrollbar.object3D.visible = false;\n                this.plane.classList.remove(this.web2vr.settings.interactiveTag);\n            }\n        }\n    }\n}","export default class Settings {\n    constructor() {\n        this.scale = 600;\n        this.position = { x: 0, y: 2, z: -1 }\n        this.rotation = { x: 0, y: 0, z: 0 }\n        this.layerStep = 0.0005; // z space between the layers\n\n        this.parentSelector= null;\n        this.interactiveTag = \"vr-interactable\";\n        this.ignoreTags = [\"BR\", \"SOURCE\", \"SCRIPT\", \"AUDIO\", \"NOSCRIPT\"];\n\n        this.debug = false;\n        this.showClipping = false;\n        this.forceClipping = false;\n        this.experimental = false;\n\n        this.scroll = true;\n        this.scrollWindowHeight = 800;\n        this.createControllers = true;\n        this.raycasterFar = 5;\n        this.skybox = true;\n        this.border = true;\n    }\n}                  ","export default class Helper {\n    static isUrl(string) {\n        const regexp = /(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/;\n        return regexp.test(string);\n    }\n\n    static clamp(value, min, max) {\n        return Math.min(max, Math.max(min, value));\n    }\n}","export default class MouseEventHandler {\n    constructor(element) {\n        this.element = element;\n        this.listeningForMouseEvents = false;\n        this.resync();\n        this.checkEntityEvents();\n    }\n\n    resync() {\n        const mouseEvents = [\"click\", \"mouseenter\", \"mouseleave\", \"mousedown\", \"mouseup\"];\n        const mouseProperties = [\"onclick\", \"onmouseenter\", \"onmouseleave\", \"onmousedown\", \"onmouseup\"];\n\n        let hasMouseEventRegistered = false;\n        for (const mouseEvent of mouseEvents) {\n            if (this.element.domElement.eventListenerList && this.element.domElement.eventListenerList[mouseEvent]) {\n                hasMouseEventRegistered = true;\n                break;\n            }\n        }\n\n        let hasMouseProperty = false;\n        for (const mouseProperty of mouseProperties) {\n            if (this.element.domElement[mouseProperty]) {\n                hasMouseProperty = true;\n                break;\n            }\n        }\n\n        if (hasMouseEventRegistered || hasMouseProperty) {\n            if (!this.listeningForMouseEvents) {\n                this.addMouseListeners(mouseEvents);\n                this.listeningForMouseEvents = true;\n            }\n        }\n        // no event handlers or event properties registered, so we can safely remove our listeners\n        else if (this.listeningForMouseEvents) {\n            this.removeMouseListeners(mouseEvents);\n            this.listeningForMouseEvents = false;\n        }\n    }\n    mouseEventHandler(evt) {\n        const mouseEvent = new MouseEvent(evt.type, {\n            \"view\": window,\n            \"bubbles\": true,\n            \"cancelable\": true,\n            \"target\": this.element.domElement // maybe?\n        });\n        this.element.domElement.dispatchEvent(mouseEvent);\n    }\n\n    addMouseListeners(mouseEvents) {\n        mouseEvents.forEach(eventName => {\n            this.element.entity.addEventListener(eventName, this.mouseEventHandler.bind(this))\n        })\n    }\n\n    removeMouseListeners(mouseEvents) {\n        mouseEvents.forEach(eventName => {\n            this.element.entity.removeEventListener(eventName, this.mouseEventHandler.bind(this))\n        });\n    }\n\n    // for hover and input element\n    checkEntityEvents() {\n        const mouseEvents = [\"click\", \"mouseenter\", \"mouseleave\", \"mousedown\", \"mouseup\"];\n        for (const mouseEvent of mouseEvents) {\n            if (this.element.entity.eventListenerList && this.element.entity.eventListenerList[mouseEvent]) {\n                this.listeningForMouseEvents = true;\n                break;\n            }\n        }\n    }\n}","export default class Position {\n    constructor(domPosition, depth, scale) {\n        // depth = z\n        this.depth = depth;\n        this.startDepth = depth;\n        this.scale = scale;\n        this.scrollY = 0;\n        this.updatePosition(domPosition);\n    }\n\n    updatePosition(domPosition) {\n        this.domPosition = domPosition;\n        this.aframePosition = this.calculateAFramePosition(this.domPosition);\n    }\n\n    calculateAFramePosition(domPosition) {\n        // making positions be in center because dom positions are in top left\n        const aframePosition = {\n            x: domPosition.x + domPosition.width / 2,\n            y: domPosition.y + domPosition.height / 2,\n            z: this.depth\n        };\n\n        // scaling\n        aframePosition.x *= this.scalingFactor;\n        aframePosition.y *= this.scalingFactor * -1; // * -1 to match aframe y-axis\n\n        aframePosition.width = domPosition.width * this.scalingFactor;\n        aframePosition.height = domPosition.height * this.scalingFactor;\n\n        return aframePosition;\n    }\n\n    equalsDOMPosition(domPosition) {\n        return this.domPosition.top == domPosition.top && this.domPosition.bottom == domPosition.bottom && this.domPosition.left == domPosition.left && this.domPosition.right == domPosition.right;\n    }\n\n    get scalingFactor() {\n        return 1 / this.scale;\n    }\n\n    get x() {\n        return this.aframePosition.x;\n    }\n\n    get y() {\n        return this.aframePosition.y + this.scrollY;\n    }\n\n    get z() {\n        return this.aframePosition.z;\n    }\n\n    get width() {\n        return this.aframePosition.width;\n    }\n\n    get height() {\n        return this.aframePosition.height;\n    }\n\n    // vector3\n    get xyz() {\n        return { x: this.x, y: this.y, z: this.z };\n    }\n\n    get left() {\n        return { x: this.x - this.width / 2, y: this.y, z: this.z };\n    }\n\n    get right() {\n        return { x: this.x + this.width / 2, y: this.y, z: this.z };\n    }\n\n    get top() {\n        return { x: this.x, y: this.y + this.height / 2, z: this.z };\n    }\n\n    get bottom() {\n        return { x: this.x, y: this.y - this.height / 2, z: this.z };\n    }\n\n}","import \"./plugins/eventListenerListPlugin\"; // Get all event listeners for DOM elements\nimport Deepmerge from \"deepmerge\";\nimport \"aframe-gif-shader\";\n//import \"./plugins/aframe-keyboard.min\";\n//import \"super-hands\";\nimport Settings from \"./settings\";\nimport \"./components/border\";\nimport \"./components/animate\";\nimport \"./components/grabRotateStatic\";\nimport Scroll from \"./scroll\"\nimport AframeContext from \"./aframeContext\";\nimport ContainerElement from \"./elements/containerElement\";\nimport TextElement from \"./elements/textElement\";\nimport ImageElement from \"./elements/imageElement\";\nimport VideoElement from \"./elements/videoElement\";\nimport CheckBoxElement from \"./elements/checkboxElement\";\nimport RadioElement from \"./elements/radioElement\";\nimport InputElement from \"./elements/inputElement\";\nimport ButtonElement from \"./elements/buttonElement\";\nimport SvgElement from \"./elements/svgElement\";\nimport CanvasElement from \"./elements/canvasElement\";\n\nexport default class Web2VR {\n    constructor(container, settings = {}) {\n        // main div container\n        if (container.nodeType == Node.ELEMENT_NODE)\n            this.container = container;\n        else\n            this.container = document.querySelector(container);\n\n        // deep merge settings\n        this.settings = Deepmerge(new Settings(), settings, {\n            arrayMerge: (destination, source) => {\n                return [...destination, ...source];\n            }\n        });\n\n        // aframe context\n        this.aframe = new AframeContext(this.settings);\n        // vr elements\n        this.elements = new Set();\n        // set of all the hover css selectors\n        this.hoverSelectors = new Set();\n        this.observer = null;\n        // observer parametars\n        this.observerConfig = { childList: true, subtree: true, characterData: true, attributes: true };//attributeFilter: [\"style\", \"class\", \"id\"]\n        this.updating = false;\n\n        // experimental only\n        this.html2canvasIDcounter = 0;\n    }\n\n    // find all hover css rules and add {selector}hover class to them\n    findHoverCss() {\n        try {\n            for (const styleSheet of [...document.styleSheets]) {\n                for (const rule of [...styleSheet.cssRules]) {\n                    if (rule instanceof CSSStyleRule) {\n                        const selectors = rule.selectorText.split(\",\");\n                        for (const selector of selectors) {\n                            const sel = selector.split(\":\");\n                            // is hover\n                            if (sel[1] == \"hover\") {\n                                const s = sel[0].replace(/\\s/g, '');\n                                if (s[0] == \".\")\n                                    rule.selectorText += `, ${s}hover`;\n                                else if (s[0] == \"#\")\n                                    rule.selectorText += `, .${s.substr(1)}hover`;\n                                else\n                                    rule.selectorText += `, .${s}hover`;\n                                this.hoverSelectors.add(s);\n                            }\n                        }\n                    }\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n    }\n\n    // add all svg needed styles to defs inside svg so we can convert svg to png with all styles applied \n    generateStyleDefs(svgDomElement) {\n        let styleDefs = \"\";\n        const sheets = document.styleSheets;\n        for (let i = 0; i < sheets.length; i++) {\n            const rules = sheets[i].cssRules;\n            for (let j = 0; j < rules.length; j++) {\n                const rule = rules[j];\n                if (rule.style) {\n                    const selectorText = rule.selectorText;\n                    const elems = svgDomElement.querySelectorAll(selectorText);\n                    if (elems.length) {\n                        styleDefs += selectorText + \" { \" + rule.style.cssText + \" }\\n\";\n                    }\n                }\n            }\n        }\n\n        const s = document.createElement('style');\n        s.setAttribute('type', 'text/css');\n        s.innerHTML = styleDefs;\n\n        const defs = document.createElement('defs');\n        defs.appendChild(s);\n        svgDomElement.insertBefore(defs, svgDomElement.firstChild);\n    }\n\n    start() {\n        this.findHoverCss();\n\n        if (!this.aframe.scene.hasLoaded)\n            this.aframe.scene.addEventListener(\"loaded\", this.init(), { once: true });\n        else\n            this.init();\n    }\n\n    init() {\n        this.aframe.createContainer(this);\n        this.aframe.createControllers();\n\n        this.convertToVR();\n        // scroll feature\n        this.scroll = new Scroll(this);\n\n        this.allLoadedUpdate();\n    }\n\n    // update once after all images are loaded in the dom\n    allLoadedUpdate() {\n        const interval = setInterval(() => {\n            let allLoaded = true;\n            for (const element of this.elements)\n                if (element instanceof ImageElement && !element.loaded)\n                    allLoaded = false;\n            if (allLoaded) {\n                this.update();\n                clearInterval(interval);\n            }\n        }, 100);\n    }\n\n    addElement(domElement, parentElement, layer) {\n        // ignore tag if in ignoreTags list or text element(vr-span) is already added\n        if (this.settings.ignoreTags.includes(domElement.tagName) || (domElement.classList && domElement.classList.contains(\"vr-span\")))\n            return null;\n\n        let element = null;\n        // its text node and not empty\n        if (domElement.nodeType == Node.TEXT_NODE && domElement.nodeValue.trim()) {\n            const span = document.createElement(\"span\");\n            span.classList.add(\"vr-span\");\n            span.textContent = domElement.textContent;\n\n            // dont want observer to listen changes when adding(replacing) span text into dom\n            if (this.observer)\n                this.observer.disconnect();\n            domElement.replaceWith(span);\n            if (this.observer)\n                this.observer.observe(this.container, this.observerConfig);\n\n            element = new TextElement(this, span, layer);\n        }\n        // for future convert this to switch statement\n        else if (domElement.tagName == \"VIDEO\")\n            element = new VideoElement(this, domElement, layer);\n        else if (domElement.tagName == \"IMG\")\n            element = new ImageElement(this, domElement, layer);\n        else if (domElement.tagName == \"svg\")\n            element = new SvgElement(this, domElement, layer);\n        else if (domElement.tagName == \"CANVAS\")\n            element = new CanvasElement(this, domElement, layer);\n        else if (domElement.tagName == \"BUTTON\")\n            element = new ButtonElement(this, domElement, layer);\n        else if (domElement.tagName == \"TEXTAREA\")\n            element = new InputElement(this, domElement, layer);\n        else if (domElement.tagName == \"INPUT\") {\n            const type = domElement.getAttribute(\"type\");\n            if (type == \"checkbox\")\n                element = new CheckBoxElement(this, domElement, layer);\n            else if (type == \"radio\")\n                element = new RadioElement(this, domElement, layer);\n            else if ([\"text\", \"email\", \"number\", \"password\", \"search\", \"tel\", \"url\"].includes(type))\n                element = new InputElement(this, domElement, layer);\n            else if ([\"button\", \"submit\", \"reset\"].includes(type)) {\n                element = new ButtonElement(this, domElement, layer);\n            }\n            else\n                return;\n        }\n        // any other type of element will be container\n        else if (domElement.nodeType == Node.ELEMENT_NODE) {\n            element = new ContainerElement(this, domElement, layer);\n        }\n        else\n            return;\n\n        this.elements.add(element);\n        this.aframe.container.appendChild(element.entity);\n\n        if (this.settings.debug)\n            console.log(\"Added element\", element);\n\n        // init element and add element to parent children when aframe entity is loaded(play)\n        const onLoaded = (event) => {\n            if (parentElement)\n                parentElement.childElements.add(element);\n            element.init();\n            element.update();\n        };\n        element.entity.addEventListener(\"play\", onLoaded, { once: true });\n\n        return element;\n    }\n\n    removeElement(element) {\n        // remove the element\n        this.aframe.container.removeChild(element.entity);\n        this.elements.delete(element);\n        // remove all the children of the element recursively\n        for (const child of element.childElements) {\n            this.removeElement(child);\n        }\n    }\n\n    // start at root and interate over child nodes recursively\n    addElementChildren(currentNode, parentElement = null, layer = 0) {\n        if (currentNode.tagName == \"svg\")\n            this.generateStyleDefs(currentNode);\n\n        const element = this.addElement(currentNode, parentElement, layer);\n        // not supported tags or svg element that we dont need to check its children\n        if (!element || element instanceof SvgElement)\n            return;\n\n        if (currentNode.childNodes && currentNode.childNodes.length > 0) {\n            layer++;\n            for (const child of currentNode.childNodes)\n                this.addElementChildren(child, element, layer);\n        }\n    }\n\n    convertToVR() {\n        this.addElementChildren(this.container);\n        // observer dom element changes and for newly added and deleted dom elements\n        this.observer = new MutationObserver((mutations) => {\n            for (const mutation of mutations) {\n                let emptyRemove = false;\n                for (const node of mutation.removedNodes) {\n                    // not empty textNode\n                    if (!(node.nodeType == Node.TEXT_NODE && !node.nodeValue.trim()))\n                        this.removeElement(node.element);\n                    else\n                        emptyRemove = true;\n                }\n\n                for (const node of mutation.addedNodes)\n                    this.addElementChildren(node, mutation.target.element, mutation.target.element.layer + 1);\n\n                if (!emptyRemove) {\n                    // when adding new nodes we also need to check for new loaded images\n                    if (mutation.addedNodes.length > 0)\n                        this.allLoadedUpdate();\n                    else\n                        this.update();\n                }\n            }\n        });\n        this.observer.observe(this.container, this.observerConfig);\n    }\n\n    update() {\n        // we check for updating so we dont do multiple updating at same time from the async functions\n        this.updating = true;\n        if (this.updating) {\n            // using try and catch because sometimes when element is removed it calls update after and it wont find element, the errors doesnt matter because the final result is the same\n            try {\n                for (const element of this.elements)\n                    element.update();\n            }\n            catch (err) {\n                console.error(err);\n            }\n            this.scroll.update();\n            this.updating = false;\n        }\n    }\n}\n"],"sourceRoot":""}